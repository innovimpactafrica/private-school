<div class="flex min-h-screen bg-[#EDF1F7]">
    <!-- Sidebar -->
    <app-sidebar></app-sidebar>

    <!-- Main content -->
    <div class="flex-1 flex flex-col">
        <!-- Header -->
        <app-header></app-header>

        <main class="px-8 py-5">
            <!-- Breadcrumb + Actions -->
            <div class="flex items-center justify-between mb-5">
                <div class="flex items-center gap-3">
                    <button type="button" (click)="goBack()" aria-label="Retour"
                        class="inline-flex items-center justify-center p-5 rounded-lg bg-white border border-gray-200 hover:bg-gray-50">
                        <!-- Placeholder Back SVG -->
                        <svg width="18" height="14" viewBox="0 0 18 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17 7H1M1 7L7 1M1 7L7 13" stroke="#2B3674" stroke-width="1.5"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </button>
                    <div>
                        <p class="text-sm text-[#707EAE]">Gestion des utilisateurs / Nouveau utilisateur</p>
                        <h1 class="text-2xl font-semibold text-[#2B3674]">Nouvelle École</h1>
                    </div>
                </div>
                <div class="flex items-center gap-3">
                    <button (click)="cancel()"
                        class="px-5 py-3 bg-white text-red-600 rounded-lg hover:bg-red-50">Annuler</button>
                    <button (click)="save()"
                        class="px-5 py-3 bg-[#38AA36] text-white rounded-lg hover:bg-green-600">Enregistrer</button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                <!-- Left: Informations générales -->
                <section class="col-span-2 bg-white rounded-xl p-6">
                    <h2 class="text-2xl mb-4 border-b -mx-4 px-4 py-2" style="border-color: #EDF1F7;">Informations
                        générales</h2>
                    <div class="space-y-5">
                        <div>
                            <label class="block text-base text-gray-700 mb-2">Nom de l’école</label>
                            <input [(ngModel)]="name" type="text" placeholder="Ex : lycée el amine"
                                class="w-full rounded-lg border border-[#CBD5E1] px-4 py-3 focus:outline-none focus:ring-0 focus:border-[#CBD5E1]" />
                        </div>
                        <div>
                            <label class="block text-base text-gray-700 mb-2">Adresse</label>
                            <input [(ngModel)]="address" type="text" placeholder="Ex : yeumbeul"
                                class="w-full rounded-lg border border-[#CBD5E1] px-4 py-3 focus:outline-none focus:ring-0 focus:border-[#CBD5E1]" />
                        </div>
                        <div>
                            <label class="block text-base text-gray-700 mb-2">Logo</label>
                            <div class="rounded-lg bg-[#F2F4F7] text-gray-500 p-6 text-center cursor-pointer"
                                (drop)="onDropLogo($event)" (dragover)="onDragOver($event)" role="button" tabindex="0">
                                <label for="logo-file-input" class="flex flex-col items-center gap-2 cursor-pointer">
                                    <!-- Placeholder upload icon -->
                                    <span>glisser et déposer le fichier</span>
                                    <svg width="31" height="21" viewBox="0 0 31 21" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M16.5726 20.5V14.7857H20.8586L15.5011 9.07143L10.1435 14.7857H14.4296V20.5H9.07204V20.4524C8.89203 20.4619 8.72059 20.5 8.53629 20.5C6.40493 20.5 4.36087 19.7475 2.85377 18.4079C1.34668 17.0684 0.5 15.2515 0.5 13.3571C0.5 9.69238 3.61808 6.70572 7.61908 6.29619C7.96987 4.66627 8.9487 3.19594 10.3872 2.13809C11.8257 1.08025 13.634 0.501006 15.5011 0.5C17.3684 0.500929 19.177 1.0801 20.6158 2.13792C22.0547 3.19575 23.034 4.66612 23.3852 6.29619C27.3862 6.70572 30.5 9.69238 30.5 13.3571C30.5 15.2515 29.6533 17.0684 28.1462 18.4079C26.6391 19.7475 24.5951 20.5 22.4637 20.5C22.2837 20.5 22.1101 20.4619 21.928 20.4524V20.5H16.5726Z"
                                            fill="#A5A5A5" />
                                    </svg>
                                    <span class="text-xs text-gray-400" *ngIf="logoFile">{{ logoFile.name }}</span>
                                </label>
                                <input id="logo-file-input" #fileInput type="file" class="sr-only"
                                    (change)="onFileInput($event)" />
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Right: Configuration des horaires -->
                <section class="col-span-3 bg-white rounded-xl p-6">
                    <h2 class="text-2xl mb-4 border-b -mx-4 px-4 py-2" style="border-color: #EDF1F7;">Configuration des
                        horaires</h2>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="text-[#2F2884]">
                                <tr class="border-b" style="border-color: #EDF1F7;">
                                    <th class="text-left py-3">Jour</th>
                                    <th class="text-left py-3">Disponibilité</th>
                                    <th class="text-left py-3">Ouverture</th>
                                    <th class="text-left py-3">Fermeture</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let d of days" class="border-b" style="border-color: #EDF1F7;">
                                    <td class="py-3">{{ d.day }}</td>
                                    <td class="py-3">
                                        <label class="inline-flex items-center gap-2 cursor-pointer ">
                                            <input type="checkbox" [(ngModel)]="d.open"
                                                (ngModelChange)="onToggleOpen(d)"
                                                class="form-checkbox checkbox-green w-4 h-4 rounded border-gray-300 text-[#38AA36] focus:ring-[#38AA36] focus:ring-1 focus:ring-offset-0 checked:bg-[#38AA36] checked:border-[#38AA36]"
                                                style="accent-color: #38AA36;" />
                                            <span>{{ d.open ? 'Ouvert' : 'Fermé' }}</span>
                                        </label>
                                    </td>
                                    <td class="py-3">
                                        <app-time-picker [value]="d.openTime" (valueChange)="d.openTime = $event"
                                            [disabled]="!d.open" [minuteStep]="1" format="24h"></app-time-picker>
                                    </td>
                                    <td class="py-3">
                                        <app-time-picker [value]="d.closeTime" (valueChange)="d.closeTime = $event"
                                            [disabled]="!d.open" [minuteStep]="1" format="24h"></app-time-picker>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </main>
    </div>
</div>

<!-- Success Popup -->
<div *ngIf="showSuccess" class="fixed inset-0 z-50 flex items-center justify-center">
    <div class="absolute inset-0 bg-black/10"></div>
    <div class="relative bg-white rounded-2xl shadow-lg px-16 py-14 text-center select-none">
        <div class="mx-auto mb-8 flex items-center justify-center">
            <!-- Green check icon inside a circle -->
            <svg width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="60" cy="60" r="50" stroke="#38AA36" stroke-width="8" fill="none" />
                <path d="M40 62L55 77L82 50" stroke="#38AA36" stroke-width="8" stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
        </div>
        <p class="text-lg leading-7 px-16 text-gray-800">
            <span class="font-semibold">L’école</span> a été ajoutée avec succès
        </p>
    </div>
</div>